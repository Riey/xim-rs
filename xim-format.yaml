Enums:
  AttrType:
    repr: u16
    variants:
      Separator: 0
      Byte: 1
      Word: 2
      Long: 3
      Char: 4
      Window: 5
      Style: 10
      XRectangle: 11
      XPoint: 12
      XFontSet: 13
      HotkeyTriggers: 15
      StringConversion: 17
      PreeditState: 18
      ResetState: 19
      NestedList: 0x7fff
  CaretStyle:
    repr: u32
    variants:
      Invisible: 0
      Primary: 1
      Secondary: 2

Structs:
  Attr:
    - "id u16"
    - "ty AttrType"
    - "name @pad string"

Requests:
  Connect:
    major_opcode: 1
    minor_opcode: ~
    body:
      - "endian @append1 Endian"
      - "client_major_protocol_version u16"
      - "client_minor_protocol_version u16"
      - "client_auth_protocol_names @list @pad string"

  ConnectReply:
    major_opcode: 2
    minor_opcode: ~
    body:
      - "server_major_protocol_version u16"
      - "server_minor_protocol_version u16"

  Open:
    major_opcode: 30
    minor_opcode: ~
    body:
      - "name @pad string1"

  OpenReply:
    major_opcode: 31
    minor_opcode: ~
    body:
      - "input_method_id u16"
      - "im_attrs @list Attr<'b>"
      - "ic_attrs @list22 Attr<'b>"

  QueryExtension:
    major_opcode: 40
    minor_opcode: ~
    body:
      - "input_method_id u16"
      - "extensions @pad @list string1"
